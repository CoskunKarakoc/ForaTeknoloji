@model ForaTeknoloji.Entities.Entities.Birim
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
    //Layout = "~/Views/Shared/_LayoutNewTemplate.cshtml";
}


<div class="row animated fadeIn faster">
    <div class="col-md-4 offset-md-4">
        <div class="card border-left-info h-100 shadow-lg  mt-xl-5 mb-xl-5">
            <div class="card-header py-1 mt-1">
                <h3 class="card-title"><i class="fas fa-bookmark"></i> Birim Düzenleme</h3>
            </div>
            <div class="card-body">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    @Html.HiddenFor(model => model.Birim_No)
                    <div class="form-group">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Üst Departman</label>
                                <div class="form-group">
                                    @Html.DropDownList("Departman_No", null, "Ana Departman Seçiniz...", new { @class = "form-control chosen-select", tabindex = "2" })@*bg-translated text-light*@
                                    @Html.ValidationMessageFor(model => model.Departman_No, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Alt Departman</label>
                                <div class="form-group">
                                    @Html.DropDownList("Alt_Departman_No", null, "Alt Departman Seçiniz...", new { @class = "form-control chosen-select", tabindex = "2" })@*bg-translated text-light*@
                                    @Html.ValidationMessageFor(model => model.Alt_Departman_No, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Bölüm </label>
                                <div class="form-group">
                                    @Html.DropDownList("Bolum_No", null, "Bölüm Seçiniz...", new { @class = "form-control chosen-select", tabindex = "2" })@*bg-translated text-light*@
                                    @Html.ValidationMessageFor(model => model.Bolum_No, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Birim</label>
                                @Html.EditorFor(model => model.Adi, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.Adi, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <div class="col-md-12 text-right">
                            <button type="submit" class="btn btn-sm btn-success"><i class="fa fa-edit"></i> Güncelle</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('.chosen-select').chosen();
        $('.chosen-select-deselect').chosen({ allow_single_deselect: true });
        $("#Departman_No").chosen().change(function () {
            var departmanNo = $(this).val();
            if (departmanNo == 0 || departmanNo == null) {
                $("#Alt_Departman_No").empty();
                $("#Bolum_No").empty();
                $("#Alt_Departman_No").append('<option > Alt Departman Seçiniz... </option>');
                $("#Bolum_No").append('<option > Bölüm Seçiniz... </option>');
            } else {
                $.ajax({
                    url: '/Users/AltDepartmanListesi?Departman=' + departmanNo,
                    type: 'GET',
                    dataType: 'json'
                }).done(function (data) {
                    $("#Alt_Departman_No").empty();
                    $("#Alt_Departman_No").append('<option > Alt Departman Seçiniz... </option>');
                    $.each(data, function (index, row) {
                        $("#Alt_Departman_No").append('<option value=' + row.Value + '>' + row.Text + '</option>').trigger("chosen:updated");
                    });
                    var altdepartmanNo = $("#Alt_Departman_No").val();
                    $.ajax({
                        url: '/Users/BolumListesi?AltDepartman=' + altdepartmanNo,
                        type: 'GET',
                        dataType: 'json'
                    }).done(function (data) {
                        $("#Bolum_No").empty();
                        $.each(data, function (index, row) {
                            $("#Bolum_No").append('<option value=' + row.Value + '>' + row.Text + '</option>').trigger("chosen:updated");
                        });
                    });

                });
            }
        });
        $("#Alt_Departman_No").chosen().change(function () {
            var altdepartmanNo = $(this).val();
            $.ajax({
                url: '/Users/BolumListesi?AltDepartman=' + altdepartmanNo,
                type: 'GET',
                dataType: 'json'
            }).done(function (data) {
                $("#Bolum_No").empty();
                $.each(data, function (index, row) {
                    $("#Bolum_No").append('<option value=' + row.Value + '>' + row.Text + '</option>').trigger("chosen:updated");
                });
            });
        })
    });
</script>